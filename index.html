<!DOCTYPE html>
<html lang="en">
<head>
</head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script type="text/javascript">
  function name() {
    function getParameterByName(name, url) {
      var name = "text";
      if (!url) url = window.location.href;
      name = name.replace(/[\[\]]/g, "\\$&");
      var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
        results = regex.exec(url);
      if (!results) return null;
      if (!results[2]) return '';
      return decodeURIComponent(results[2].replace(/\+/g, " "));
    }
    var foo = getParameterByName('text');
    console.log(foo);
    var a = document.getElementById("id01");
    a.value = foo;
    var data = "{\"longUrl\":\"" + String(window.location) + "\"}"
    console.log(data);
    var settings = {
      "async": true,
      "crossDomain": true,
      "url": "https://www.googleapis.com/urlshortener/v1/url?key=AIzaSyBVGDRITl5UZZ6jsAaHdzQ55XgJxuz74og",
      "method": "POST",
      "headers": {
        "Content-Type": "application/json",
        "Cache-Control": "no-cache",
      },
      "processData": false,
      "data": data
    }
    $.ajax(settings).done(function(response) {
      console.log(response.id);
    });
  }
</script>
<body onload="name()">
  <input id="id01" type="text" size="25" />
  <a class="button" id="googleLink" href="willBeChanged" onclick="this.href='?text=' + encodeURIComponent(document.getElementById('id01').value);">
    <span>Сгенерировать ссылку</span>
  </a>
  <button class="btn" data-clipboard-action="copy" data-clipboard-target="#id01">Скопировать</button>
  <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
  <script>
    var clipboard = new ClipboardJS('.btn');
    clipboard.on('success', function(e) {
      console.log(e);
    });
    clipboard.on('error', function(e) {
      console.log(e);
    });
  </script>
</body>
</html>
