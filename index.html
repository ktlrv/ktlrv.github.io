<!DOCTYPE html>
<html lang="en">

<head>
  <link rel="stylesheet" href="style.css">
</head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/semantic-ui@2.3.1/dist/semantic.min.css">
<script src="https://cdn.jsdelivr.net/npm/semantic-ui@2.3.1/dist/semantic.min.js"></script>


<script type="text/javascript">
  function name() {

    function getParameterByName(name, url) {
      var name = "text";
      if (!url) url = window.location.href;
      name = name.replace(/[\[\]]/g, "\\$&");
      var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
        results = regex.exec(url);
      if (!results) return null;
      if (!results[2]) return '';
      return decodeURIComponent(results[2].replace(/\+/g, " "));
    }
    var foo = getParameterByName('text');
    console.log(foo);

    if(foo == "" || foo == null){
      document.getElementById("copyText").remove();
      document.getElementById("link").remove();
    }
    else{
      document.getElementById("googleLink").remove();
      document.getElementById('id01').readOnly = true;
    }


    console.log(foo);
    var a = document.getElementById("id01");
    a.value = foo;
    var data = "{\"longUrl\":\"" + String(window.location) + "\"}"
    console.log(data);
    var settings = {
      "async": true,
      "crossDomain": true,
      "url": "https://www.googleapis.com/urlshortener/v1/url?key=AIzaSyBVGDRITl5UZZ6jsAaHdzQ55XgJxuz74og",
      "method": "POST",
      "headers": {
        "Content-Type": "application/json",
        "Cache-Control": "no-cache",
      },
      "processData": false,
      "data": data
    }
    $.ajax(settings).done(function(response) {
      document.getElementById("link").textContent = response.id;
    });
  }
</script>






<div class="Content">
  <body onload="name()">
    <div class="ui input">
      <input id="id01" type="text" size="25" />
    </div>
    <br>
    <button id="googleLink" class="ui primary basic button" data-clipboard-action="copy" onclick="location.href='?text=' + encodeURIComponent(document.getElementById('id01').value);">Сгенерировать ссылку</button>
    <!-- <a class="button" id="googleLink" href="willBeChanged" onclick="this.href='?text=' + encodeURIComponent(document.getElementById('id01').value);">
        Сгенерировать ссылку
      </a> -->
    <button id="copyText" class="ui primary basic button" data-clipboard-action="copy" data-clipboard-target="#id01">Скопировать текст</button>
    <p id="link"></p>
  </body>

</div>
<script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
  var clipboard = new ClipboardJS('.button');
  clipboard.on('success', function(e) {
    console.log(e);
  });
  clipboard.on('error', function(e) {
    console.log(e);
  });
</script>

</html>
